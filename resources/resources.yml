resources:
  jobs:
    unit_tests:
      name: "[${bundle.target}] Unit Tests"
      
      job_clusters:
        - job_cluster_key: test_cluster
          new_cluster:
            spark_version: "14.3.x-scala2.12"
            node_type_id: "Standard_DS3_v2"
            num_workers: 0
            spark_conf:
              "spark.databricks.cluster.profile": "singleNode"
              "spark.master": "local[*]"
            custom_tags:
              "ResourceClass": "SingleNode"

      tasks:
        - task_key: run_unit_tests
          job_cluster_key: test_cluster
          spark_python_task:
            python_file: ../tests/run_tests.py
          libraries:
            - pypi:
                package: pytest
            - pypi:
                package: databricks-sdk

